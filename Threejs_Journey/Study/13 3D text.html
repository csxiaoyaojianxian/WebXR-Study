<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link type="text/css" rel="stylesheet" href="./public.css" />
</head>

<body>

    <section class="text js-text">
        <h2>Introduction</h2>
<p>We already know enough basics to create some content. For our first project, we will re-create what ilithya did with her cool portfolio <a target="_blank" href="https://www.ilithya.rocks/">https://www.ilithya.rocks/</a> and have a big 3D text in the middle of the scene with objects floating around.</p>
<p>This portfolio is an excellent example of what you can do quite early when learning Three.js. It simple, efficient, and it looks great.</p>
<p>Three.js already supports 3D text geometries with the <a target="_blank" href="https://threejs.org/docs/?q=textge#examples/en/geometries/TextGeometry">TextGeometry</a> class. The problem is that you must specify a font, and this font must be in a particular json format called typeface.</p>
<p>We won't talk about licenses, but you must have the right to use the font unless it's for personal usage.</p>
<h2>How to get a typeface font</h2>
<p>There are many ways of getting fonts in that format. First, you can convert your font with converters like this one: <a target="_blank" href="http://gero3.github.io/facetype.js/">https://gero3.github.io/facetype.js/</a>. You have to provide a file and click on the convert button.</p>
<p>You can also find fonts in the Three.js examples located in the <code spellcheck="false">/node_modules/three/examples/fonts/</code> folder. You can take those fonts and put them in the <code spellcheck="false">/static/</code> folder, or you can import them directly in your JavaScript file because they are json and <code spellcheck="false">.json</code> files are supported just like <code spellcheck="false">.js</code> files in Webpack:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">import</span> typefaceFont <span class="token keyword">from</span> <span class="token string">'three/examples/fonts/helvetiker_regular.typeface.json'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>We will mix those two techniques by opening the <code spellcheck="false">/node_modules/three/examples/fonts/</code>, taking the <code spellcheck="false">helvetiker_regular.typeface.json</code> and <code spellcheck="false">LICENSE</code> files, and putting these in the <code spellcheck="false">/static/fonts/</code> folder (that you need to create).</p>
<p>The font is now accessible just by writing <code spellcheck="false">/fonts/helvetiker_regular.typeface.json</code> at the end of the base URL.</p>
<h2>Load the font</h2>
<p>To load the font, we must use a new loader class called <a target="_blank" href="https://threejs.org/docs/#examples/en/loaders/FontLoader">FontLoader</a>.</p>
<p>This class is not available in the <code spellcheck="false">THREE</code> variable. We need to import it like we did with the <code spellcheck="false">OrbitControls</code> class earlier in the course:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> FontLoader <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'three/examples/jsm/loaders/FontLoader.js'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>This loader works like the <a target="_blank" href="https://threejs.org/docs/index.html#api/en/loaders/TextureLoader">TextureLoader</a>. Add the following code after the <code spellcheck="false">textureLoader</code> part (if you are using another font, don't forget to change the path):</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token comment">/**
* Fonts
*/</span>
<span class="token keyword">const</span> fontLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FontLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

fontLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
<span class="token string">'/fonts/helvetiker_regular.typeface.json'</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token parameter">font</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>You should get <code spellcheck="false">'loaded'</code> in you console. If not, check the previous steps and search for potential errors in the console.</p>
<p>We now have access to the font by using the <code spellcheck="false">font</code> variable inside the function. Unlike the <a target="_blank" href="https://threejs.org/docs/index.html#api/en/loaders/TextureLoader">TextureLoader</a>, we have to write the rest of our code inside that success function. </p>
<h2>Create the geometry</h2>
<p>As we said earlier, we are going to use <a target="_blank" href="https://threejs.org/docs/?q=textge#examples/en/geometries/TextGeometry">TextGeometry</a>.</p>
<p>Like for the <a target="_blank" href="https://threejs.org/docs/#examples/en/loaders/FontLoader">FontLoader</a>, we need to import it:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> TextGeometry <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'three/examples/jsm/geometries/TextGeometry.js'</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>Be careful with the example code on the <a target="_blank" href="https://threejs.org/docs/index.html#api/en/geometries/TextBufferGeometry">documentation page</a>; the values are much bigger than those in our scene.</p>
<p>Make sure to write your code inside the success function:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">fontLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
<span class="token string">'/fonts/helvetiker_regular.typeface.json'</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token parameter">font</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
<span class="token keyword">const</span> textGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextGeometry</span><span class="token punctuation">(</span>
    <span class="token string">'Hello Three.js'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        font<span class="token operator">:</span> font<span class="token punctuation">,</span>
        size<span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
        curveSegments<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        bevelEnabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        bevelThickness<span class="token operator">:</span> <span class="token number">0.03</span><span class="token punctuation">,</span>
        bevelSize<span class="token operator">:</span> <span class="token number">0.02</span><span class="token punctuation">,</span>
        bevelOffset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        bevelSegments<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> textMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>textGeometry<span class="token punctuation">,</span> textMaterial<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-01.png" src="./assets/lessons/13/step-01.png" width="1792" height="1120" alt="./assets/lessons/13/step-01.png" class="is-loaded"></span></p>
<p>You should get a white 3D text that needs improvements.</p>
<p>First, get rid of the cube. Its purpose was to make sure that everything is working.</p>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-02.png" src="./assets/lessons/13/step-02.png" width="1792" height="1120" alt="./assets/lessons/13/step-02.png" class="is-loaded"></span></p>
<p>If you want to see something cool, add <code spellcheck="false">wireframe: true</code> to your material.</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> textMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> wireframe<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-03.png" src="./assets/lessons/13/step-03.png" width="1792" height="1120" alt="./assets/lessons/13/step-03.png" class="is-loaded"></span></p>
<p>You can now see how the geometry is generated, and there are a lot of triangles. Creating a text geometry is long and hard for the computer. Avoid doing it too many times and keep the geometry as low poly as possible by reducing the <code spellcheck="false">curveSegments</code> and <code spellcheck="false">bevelSegments</code> properties.</p>
<p>Remove the <code spellcheck="false">wireframe</code> once you're happy with the level of details.</p>
<h2>Center the text</h2>
<p>There are several ways to center the text. One way of doing it is by using bounding. The bounding is the information associated with the geometry that tells what space is taken by that geometry. It can be a box or a sphere.</p>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/boundings.png" src="./assets/lessons/13/boundings.png" width="1920" height="1080" alt="./assets/lessons/13/boundings.png" class="is-loaded"></span></p>
<p>You cannot actually see those boundings, but it helps Three.js easily calculate if the object is on the screen, and if not, the object won't even be rendered. That is called frustum culling, but it's not the subject of this lesson.</p>
<p>What we want is to use this bounding to know the size of the geometry and recenter it. By default, Three.js is using sphere bounding. What we want is a box bounding, to be more precise. To do so, we can ask Three.js to calculate this box bounding by calling <code spellcheck="false">computeBoundingBox()</code> on the geometry:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">textGeometry<span class="token punctuation">.</span><span class="token function">computeBoundingBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>And we can check this box with the <code spellcheck="false">boundingBox</code> property on the geometry.</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>The result is an object called <a target="_blank" href="https://threejs.org/docs/index.html#api/en/math/Box3">Box3</a> that has a <code spellcheck="false">min</code> property and a <code spellcheck="false">max</code> property. The <code spellcheck="false">min</code> property isn't at <code spellcheck="false">0</code> as we could have expected. That is due to the <code spellcheck="false">bevelThickness</code> and <code spellcheck="false">bevelSize</code>, but we can ignore this for now.</p>
<p>Now that we have the measures, we can move the object. Instead of moving the mesh, we are going to move the whole geometry. This way, the mesh will still be in the center of the scene, but the text geometry will also be centered inside our mesh.</p>
<p>To do this, we can use the <code spellcheck="false">translate(...)</code> method on our geometry right after the <code spellcheck="false">computeBoundingBox()</code> method:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">textGeometry<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>
<span class="token operator">-</span> textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>x <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
<span class="token operator">-</span> textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>y <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
<span class="token operator">-</span> textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>z <span class="token operator">*</span> <span class="token number">0.5</span>
<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-04.png" src="./assets/lessons/13/step-04.png" width="1792" height="1120" alt="./assets/lessons/13/step-04.png" class="is-loaded"></span></p>
<p>The text should be centered but if you want to be very precise, you should also subtract the <code spellcheck="false">bevelSize</code> which is <code spellcheck="false">0.02</code>:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">textGeometry<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>x <span class="token operator">-</span> <span class="token number">0.02</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token comment">// Subtract bevel size</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>y <span class="token operator">-</span> <span class="token number">0.02</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token comment">// Subtract bevel size</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>textGeometry<span class="token punctuation">.</span>boundingBox<span class="token punctuation">.</span>max<span class="token punctuation">.</span>z <span class="token operator">-</span> <span class="token number">0.03</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span>  <span class="token comment">// Subtract bevel thickness</span>
<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>What we did here can actually be done much faster by calling the <code spellcheck="false">center()</code> method on the geometry:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-glsl"><code spellcheck="false" class=" language-glsl">textGeometry<span class="token punctuation">.</span><span class="token function">center</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>GLSL</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>So much easier, isn't it? The point of doing it ourselves was to learn about boundings and frustum culling. </p>
<h2>Add a matcap material</h2>
<p>It's time to add a cool material to our text. We are going to use a <a target="_blank" href="https://threejs.org/docs/index.html#api/en/materials/MeshMatcapMaterial">MeshMatcapMaterial</a> because it looks cool, and it has great performance.</p>
<p>First, let's choose a matcap texture. We are going to use the matcaps located in the <code spellcheck="false">/static/textures/matcaps/</code> folder but feel free to use your own matcaps.</p>
<p>You can also download one from this repository <a target="_blank" href="https://github.com/nidorx/matcaps">https://github.com/nidorx/matcaps</a>. Don't spend too much time choosing it! If it's not for personal usage, make sure you have the right to use it. You don't need a high-resolution texture and <code spellcheck="false">256x256</code> should be more than enough.</p>
<p>We can now load the texture by using the <a target="_blank" href="https://threejs.org/docs/index.html#api/en/loaders/TextureLoader">TextureLoader</a> already in the code:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> matcapTexture <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'/textures/matcaps/1.png'</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>We can now replace our ugly <a target="_blank" href="https://threejs.org/docs/index.html#api/en/materials/MeshBasicMaterial">MeshBasicMaterial</a> by a beautiful <a target="_blank" href="https://threejs.org/docs/index.html#api/en/materials/MeshMatcapMaterial">MeshMatcapMaterial</a> and use our <code spellcheck="false">matcapTexture</code> variable with the <code spellcheck="false">matcap</code> property:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> textMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshMatcapMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> matcap<span class="token operator">:</span> matcapTexture <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-05.png" src="./assets/lessons/13/step-05.png" width="1792" height="1120" alt="./assets/lessons/13/step-05.png" class="is-loaded"></span></p>
<p>You should have a lovely text with a cool looking material on it.</p>
<h2>Add objects</h2>
<p>Let's add objects floating around. To do that, we will create one donut but inside a loop function.</p>
<p>In the success function, right after the <code spellcheck="false">text</code> part, add the loop function:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>We could have done this outside of the success function but we are going to need the text and the objects being created together for a good reason that you'll see a little later.</p>
<p>In this loop, create a <a target="_blank" href="https://threejs.org/docs/#api/en/geometries/TorusGeometry">TorusGeometry</a> (such a technical name for a donut), the same material as for the text and the <a target="_blank" href="https://threejs.org/docs/#api/en/objects/Mesh">Mesh</a>:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">const</span> donutGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TorusGeometry</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> donutMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshMatcapMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> matcap<span class="token operator">:</span> matcapTexture <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> donut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>donutGeometry<span class="token punctuation">,</span> donutMaterial<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>donut<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-06.png" src="./assets/lessons/13/step-06.png" width="1792" height="1120" alt="./assets/lessons/13/step-06.png" class="is-loaded"></span></p>
<p>You should get 100 donuts all in the same place.</p>
<p>Let's add some randomness for their position:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">donut<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
donut<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
donut<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-07.png" src="./assets/lessons/13/step-07.png" width="1792" height="1120" alt="./assets/lessons/13/step-07.png" class="is-loaded"></span></p>
<p>You should get the 100 donuts dispersed on the scene.</p>
<p>Add randomness to the rotation. No need to rotate all 3 axes, and because the donut is symmetric, half of a revolution is enough:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript">donut<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span>
donut<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-08.png" src="./assets/lessons/13/step-08.png" width="1792" height="1120" alt="./assets/lessons/13/step-08.png" class="is-loaded"></span></p>
<p>The donuts should have rotate in all directions.</p>
<p>Finally, we can add randomness to the scale. Be careful, though; we need to use the same value for all 3 axes (<code spellcheck="false">x</code>, <code spellcheck="false">y</code>, <code spellcheck="false">z</code>):</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> scale <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
donut<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> scale<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-09.png" src="./assets/lessons/13/step-09.png" width="1792" height="1120" alt="./assets/lessons/13/step-09.png" class="is-loaded"></span></p>
<h2>Optimize</h2>
<p>Our code isn't very optimized. As we saw in a previous lesson, we can use the same material on multiple <a target="_blank" href="https://threejs.org/docs/#api/en/objects/Mesh">Meshes</a>, but we can also use the same geometry.</p>
<p>Move the <code spellcheck="false">donutGeometry</code> and the <code spellcheck="false">donutMaterial</code> out of the loop:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> donutGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TorusGeometry</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> donutMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshMatcapMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> matcap<span class="token operator">:</span> matcapTexture <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>You should get the same result, but we can go even further. The material of the <code spellcheck="false">text</code> is the same as for the <code spellcheck="false">donut</code>.</p>
<p>Let's remove the <code spellcheck="false">donutMaterial</code>, rename the <code spellcheck="false">textMaterial</code> by <code spellcheck="false">material</code> and use it for both the <code spellcheck="false">text</code> and the <code spellcheck="false">donut</code>:</p>
<div class="code-toolbar"><pre contenteditable="" class=" language-javascript"><code spellcheck="false" class=" language-javascript"><span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshMatcapMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> matcap<span class="token operator">:</span> matcapTexture <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>

<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>textGeometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>

<span class="token comment">// ...</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">const</span> donut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>donutGeometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button>Copy</button></div></div></div>
<p>We could go even further, but there is a dedicated lesson about optimizations.</p>
<h2>Go further</h2>
<p>If you want, you can add more shapes, animate them and even try other matcaps.</p>
<p class="is-image"><span class="image-inner"><img data-src="./assets/lessons/13/step-10.png" src="./assets/lessons/13/step-10.png" width="1792" height="1120" alt="./assets/lessons/13/step-10.png" class="is-loaded"></span></p>
    </section>
</body>

</html>